from bs4 import BeautifulSoup
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import re


##------------------------Build The HTML Page --------------------------------- ##


chrome_options = Options()
chrome_options.add_argument('--headless')
chrome_options.add_argument('--no-sandbox')
chrome_options.add_argument('--disable-dev-shm-usage')

driver = webdriver.Chrome("/usr/lib/chromium-browser/chromedriver",chrome_options=chrome_options)

driver.get('https://linux.huntingmalware.com/analysis/')
res = driver.execute_script("return document.documentElement.outerHTML")

driver.quit()

soup = BeautifulSoup(res, 'lxml')

##------------------------Now, The Magic------------------ ##


table = soup.find('table', {'class': 'table table-striped table-responsive'})

table= soup.find("tbody")

tr_list = soup.find_all("tr")

td_list=[]
for row in table.find_all("tr")[0:]:
        td_list.append(row.find_all("td"))

count = len(td_list)


print ("Samples Count: ", count)

for td in range(0, count):
	hash =  td_list[td][2].text
	date = re.findall("([0-9]{4}\-[0-9]{2}\-[0-9]{2})",td_list[td][1].text)
	score =  td_list[td][5].text
	
	print ("hash:", hash, "++" , "date:", date[0] , "++" , "score" ,score )

